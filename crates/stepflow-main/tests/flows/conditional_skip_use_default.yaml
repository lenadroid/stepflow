config:
  plugins:
    - name: mock
      type: mock
      components:
        mock://one_output:
          input_schema:
            type: object
            properties:
              input:
                type: string
          output_schema:
            type: object
            properties:
              output:
                type: string
          behaviors:
            { input: "a" }:
              outcome: success
              result: {output: b}
            { input: "hello"}:
              outcome: success
              result: {output: world}
        mock://handle_skip:
          input_schema:
            type: object
            properties:
              input:
                type: string
          output_schema:
            type: object
            properties:
              output:
                type: string
          behaviors:
            { input: "it was skipped" }:
              outcome: success
              result: {output: received it was skipped}
            { input: "b" }:
              outcome: success
              result: {output: received b}
            { input: null }:
              outcome: success
              result: {output: received null}
            { input: "world" }:
              outcome: success
              result: {output: received world}
input_schema:
  type: object
  properties:
    should_skip:
      type: boolean
    value:
      type: string
output_schema:
  type: object
  properties:
    result:
      type: string
    skipped_result:
      type: string
steps:
  - id: conditional_step
    component: mock://one_output
    skip_if: { $ref: { workflow: input }, path: should_skip }
    args:
      input: { $ref: { workflow: input }, path: value }
  - id: dependent_step
    component: mock://handle_skip
    args:
      input:
        $ref: { step: conditional_step }
        path: output
        on_skip:
          action: use_default
          default_value: "it was skipped"
outputs:
  dependent_result: { $ref: { step: dependent_step }, path: output }
test_cases:
  - input:
      should_skip: false
      value: "a"
  - input:
      should_skip: true
      value: "a"
  - input:
      should_skip: false
      value: "hello"